model:
  architecture:
    type: DeepGatedInteractionTransformer
    input_dim: 57
    hidden_dim: 128
    num_heads: 4
    num_layers: 4
    dropout_rate: 0.3
    use_interaction: true
    use_attention: true
  
  loss_function:
    type: TripleMarginRankingLoss
    margin: 0.5
    ranking_weight: 0.7
    pos_weight: 150.0

training:
  max_epochs: 150
  early_stop_patience: 25
  learning_rate: 0.0003
  weight_decay: 0.0001
  batch_size: 2048
  num_workers: 4
  
  optimizer:
    type: AdamW
    lr: 0.0003
    weight_decay: 0.0001
    betas: [0.9, 0.999]
  
  scheduler:
    type: CosineAnnealingWarmRestarts
    T_0: 20
    T_mult: 2
    eta_min: 0.00001
  
  gradient_clip: 1.0
  warmup_epochs: 5

data:
  train_path: src/otk/data/sorted_modeling_data.csv.gz
  validation_split: 0.12
  test_split: 0.18
  random_seed: 2026
  stratify_by_patient: true
  shuffle: true

prediction:
  threshold: 0.5
  ensemble: false
